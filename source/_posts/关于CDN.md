---
title: 关于CDN
date: 2017-08-16 20:30:06
tags: 优化
categories: 优化
---

#### 什么是 CDN？

CDN 全称 Content Delivery Network，即内容分发网络。其基本思路是尽可能避开互联网上有可能影响数据传输速度和稳定性的瓶颈和环节，使内容传输的更快、更稳定。

通过在网络各处放置节点服务器所构成的在现有的互联网基础之上的一层智能虚拟网络，CDN 系统能够实时地根据网络流量和各节点的连接、负载状况以及到用户的距离和响应时间等综合信息将用户的请求重新导向离用户最近的服务节点上。其目的是使用户可就近取得所需内容，解决 Internet 网络拥挤的状况，提高用户访问网站的响应速度。

在不同地域的用户访问网站的响应速度存在差异,为了提高用户访问的响应速度、优化现有 Internet 中信息的流动,需要在用户和服务器间加入中间层 CDN. 使用户能以最快的速度，从最接近用户的地方获得所需的信息，彻底解决网络拥塞，提高响应速度，是目前大型网站使用的流行的应用方案。

#### 传统的网络访问形式

用户访问未使用 CDN 缓存网站的过程为:

1.  用户向浏览器提供要访问的域名；
2.  浏览器调用域名解析函数库对域名进行解析，以得到此域名对应的 IP 地址；
3.  浏览器使用所得到的 IP 地址，域名的服务主机发出数据访问请求；
4.  浏览器根据域名主机返回的数据显示网页的内容。通过以上四个步骤，浏览器完成从用户处接收用户要访问的域名到从域名服务主机处获取数据的整个过程。CDN 网络是在用户和服务器之间增加 Cache 层，如何将用户的请求引导到 Cache 上获得源服务器的数据，主要是通过接管 DNS 实现。

#### 使用 CDN 的访问形式

对于 CDN 客户来说，不需要改动网站架构，只需要修改自己的 DNS 解析，设置一个 CNAME 指向 CDN 服务商即可。原理在下面会解释通过上图，我们可以了解到，使用了 CDN 缓存后的网站的访问过程变为：

1.  用户向浏览器提供要访问的域名；
2.  浏览器调用域名解析库对域名进行解析，由于 CDN 对域名解析过程进行了调整，所以解析函数库得到的是该域名对应的 CNAME 记录（由于现在已经是使用了 CDN 服务，CNAME 为 CDN 服务商域名），为了得到实际 IP 地址，浏览器需要再次对获得的 CNAME 域名进行解析以得到实际的 IP 地址；在此过程中，使用的全局负载均衡 DNS 解析，如根据地理位置信息解析对应的 IP 地址，使得用户能就近访问。（CDN 服务来提供最近的机器）
3.  此次解析得到 CDN 缓存服务器的 IP 地址，浏览器在得到实际的 IP 地址以后，向缓存服务器发出访问请求；
4.  缓存服务器根据浏览器提供的要访问的域名，通过 Cache 内部专用 DNS 解析得到此域名的实际 IP 地址，再由缓存服务器向此实际 IP 地址提交访问请求；
5.  缓存服务器从实际 IP 地址得得到内容以后，一方面在本地进行保存，以备以后使用，二方面把获取的数据返回给客户端，完成数据服务过程；
6.  客户端得到由缓存服务器返回的数据以后显示出来并完成整个浏览的数据请求过程。

#### CDN 关键技术

1.  缓存算法[Squid]；
2.  分发能力；
3.  负载均衡[Nginx]
4.  基于 DNS[BIND]；
5.  支持协议。

#### CDN 的优势

既然 CDN 的核心作用是提高网络的访问速度，那么其用户也就是访问量很大的网站，例如 ICP 、ISP、大型企业、电子商务网站和政府网站等。利用 CDN 技术，这些网站无需投资昂贵的各类服务器，设立分站点。通过采用 CDN，CDN 将负责信息传递工作，保证信息正常传输，而技术人员只需要维护网站内容，不需要考虑流量问题。这样，网站可保证用户得到更多的新业务，可以快速访问网络上的内容，获得更好的服务质量。

举个例子来讲，对于访问量比较大，而被访问内容更新周期比较长的网站，如政府网站，用户往往进行大量的查询工作。这类网站比较适合采用 CDN。还有，大家是否注意到，在所谓的宽带社区中，瓶颈是社区的对外出口。这样，如果采用 CDN 无疑对社区用户使用视频点播、网络教育等宽带应用提供了保证。

#### CDN 的不足

任何一个新事物，在给现有模式带来改进的同时，也必然存在一定的局限，CDN 也是这样。实时性不太好是 CDN 的致命缺陷。随着对 CDN 需求的逐渐升温，这一缺陷将得到改进，使来自于远程服务器的网络内容网页与复本服务器或缓存器中的网页保持同步。

解决方法是在网络内容发生变化时将新的网络内容从服务器端直接传送到缓存器，或者当对网络内容的访问增加时将数据源服务器的网络内容尽可能实时地复制到缓存服务器。
